module Sim.Output.Names
   ( printComponentActualName
   , printComponentSafeName
   , showEnum
   ) where

import qualified Data.Map.Strict as MapS
import Data.List (intersperse)
import Data.Function ((&))

import Parser.Netlist.Types.Representation (Enumerate(..))

-- |Print component name as it should appear to the designer
printComponentActualName :: [String] -> String
printComponentActualName = concat . (intersperse ".")

-- |Print component name without period separators
-- NOTE: Period separators are used in Haskell qualified names so shouldn't be used in function names, etc.
printComponentSafeName :: [String] -> String
printComponentSafeName = concat . (intersperse "'")

showEnum :: String -> Enumerate -> String
showEnum typeName (Enum_Identifier str) = typeName ++ "'Iden'" ++ str
showEnum typeName (Enum_Char chr) = typeName ++ "'Char'" ++ (characterMap MapS.! chr)
   where characterMap :: MapS.Map Char String
         characterMap =
            [ (' ',"SPACE")
            , ('!',"EXCLAMATION")
            , ('"',"QUOTE")
            , ('#',"HASH")
            , ('$',"DOLLAR")
            , ('%',"PERCENT")
            , ('&',"AMPERSAND")
            , ('\'',"TICK")
            , ('(',"LEFTPAREN")
            , (')',"RIGHTPAREN")
            , ('*',"STAR")
            , ('+',"PLUS")
            , (',',"COMMA")
            , ('-',"HYPHEN")
            , ('.',"PERIOD")
            , ('/',"FORWARDSLASH")
            , ('0',"0")
            , ('1',"1")
            , ('2',"2")
            , ('3',"3")
            , ('4',"4")
            , ('5',"5")
            , ('6',"6")
            , ('7',"7")
            , ('8',"8")
            , ('9',"9")
            , (':',"COLON")
            , (';',"SEMICOLON")
            , ('<',"LESSTHAN")
            , ('=',"EQUAL")
            , ('>',"GREATERTHAN")
            , ('?',"QUESTION")
            , ('@',"AT")
            , ('A',"A")
            , ('B',"B")
            , ('C',"C")
            , ('D',"D")
            , ('E',"E")
            , ('F',"F")
            , ('G',"G")
            , ('H',"H")
            , ('I',"I")
            , ('J',"J")
            , ('K',"K")
            , ('L',"L")
            , ('M',"M")
            , ('N',"N")
            , ('O',"O")
            , ('P',"P")
            , ('Q',"Q")
            , ('R',"R")
            , ('S',"S")
            , ('T',"T")
            , ('U',"U")
            , ('V',"V")
            , ('W',"W")
            , ('X',"X")
            , ('Y',"Y")
            , ('Z',"Z")
            , ('[',"LEFTSQUAREBRACE")
            , ('\\',"BACKSLASH")
            , (']',"RIGHTSQUAREBRACE")
            , ('^',"CAROT")
            , ('_',"UNDERSCORE")
            , ('`',"BACKTICK")
            , ('a',"a")
            , ('b',"b")
            , ('c',"c")
            , ('d',"d")
            , ('e',"e")
            , ('f',"f")
            , ('g',"g")
            , ('h',"h")
            , ('i',"i")
            , ('j',"j")
            , ('k',"k")
            , ('l',"l")
            , ('m',"m")
            , ('n',"n")
            , ('o',"o")
            , ('p',"p")
            , ('q',"q")
            , ('r',"r")
            , ('s',"s")
            , ('t',"t")
            , ('u',"u")
            , ('v',"v")
            , ('w',"w")
            , ('x',"x")
            , ('y',"y")
            , ('z',"z")
            , ('{',"LEFTBRACE")
            , ('|',"BAR")
            , ('}',"RIGHTBRACE")
            , ('~',"TILDE")
            ]
            & MapS.fromList
